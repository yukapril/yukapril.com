---
layout: post
title: 把 Windows、Linux 安装到外置硬盘(U盘)
date: 2020-04-21 21:34:00 GMT+0800
categories: [ 技术 ]
tags: [ U盘,windows,linux ]
---

我的主力机都是 Mac，但是偶尔也会用到 Windows，直接采用U盘安装和启动特别方便。最近在用 Linux，只能安装到虚拟机，效率大打折扣。也就在思考，Linux 可否和 Windows一样，安装为 U盘版？插上 U盘，控制启动顺序，直接进入
Linux？

<!-- more -->

正常来讲，不论现在你用的那个系统，在保证原系统的情况下，想直接换系统使用，无非就是虚拟机安装、U盘装或者再弄一台机器硬盘装。

简单来说，区别如下：

* 虚拟机：原系统与新系统同时运行，方便操作，缺点是非常吃机器资源，原系统和新系统都会受影响，尤其是非固态硬盘，特别慢。
* 外置U盘(硬盘)装系统：由于只有一台主机，所以一次只能启动一个系统，更换系统要关机重启。可以发挥硬件所有性能，成本低廉。
* 新电脑装：原系统与新系统同时运行，方便操作，可以发挥硬件所有性能。缺点是得花钱再买一台电脑。

体验上，如果机器配置比较好，还是建议虚拟机，比较方便快捷。尤其是付费的虚拟机（parallels之类），还能做到交互，而且常规办公之类软件运行效率也还可以。除非是新的系统也需要非常高的性能，比如用大型软件、游戏等，否则优先推荐虚拟机。

其次比较推荐U盘装系统，就是带块硬盘（U盘）就行了，临时使用非常合适。

## 安装 Windows 到U盘

由于 Windows 本身就有一个 Windows To Go 版本（WTG），相当于就是U盘版本。所以不用考虑安装原版 Windows 了。

> 按照正常方法操作，可以保证装好的U盘版 Windows，在 Mac 电脑，普通 PC 都可以正常启动。

**需要准备以下内容**

* 一个 Windows 机器。没有的话，装个虚拟机版本的也行（但是你需要会配置虚拟机，来连接U盘）；
* Windows 10 安装包，据说 Windows 8 的也可以；
* 一个超过 32G 的高速U盘（移动硬盘），太小的装不下系统；
* 下载 WTG 辅助工具（建议用第三方工具，而不是系统自带工具）。

以上准备材料，在 Windows 下备好。

**制作系统U盘方法**

使用 WTG 辅助工具，制作 Windows 高速U盘。做好U盘就完事了。

> 具体安装细节可以参考文章 [说走就走的「Windows」—— Windows To Go 制作详解](https://sspai.com/post/44699)

**使用方法**

在非 Mac 下使用：直接插上高速U盘，配置下开机启动顺序即可。很简单。

在 Mac 下使用：需要特殊准备些东西。

* 准备驱动。进入 MacOS 系统，打开 `启动转换助理` APP，选择 `操作`-`下载Windows支持软件`，保存到另一个U盘上。
* 至少准备一个兼容 Windows 的鼠标。兼容的意思是，这个鼠标放在 Windows 机器上，你不用装驱动就能用。需要鼠标的原因是进入 Windows 后，Mac 键盘鼠标都不识别。至少使用鼠标来点击，外加屏幕虚拟键盘输入。
* 由于需要至少 3 个 USB 设备（系统高速U盘、驱动U盘、鼠标），所以看下机器的 USB 口够不够，不够则还需要 USB Hub。

准备好后，先插入U盘，按住 `option/alt` 同时再按开机键。使用键盘左右键选择 `EFI Boot` 并进入 Windows。

进入 Windows 系统后，使用兼容鼠标（键盘）进行操作。完成配置信息。

最后进入 Windows 桌面，把存有驱动的U盘插上，安装驱动即可。

## 安装 Linux 到U盘

我接触过 Ubuntu(Mint) 还有 Manjaro 两类 Linux。他们的安装大同小异，不熟悉流程的可以用虚拟机模拟体验下。简单来说，就是U盘启动，选择体验 Linux(Live CD)，进入桌面，双击 Install 图标来安装 Linux。

下文内容，使用 Mint Linux 19 来说明。其他 Linux 基本类似。

**几点重要说明**

1. 以下有的操作必须在真实的机器上操作，虚拟机不行；
2. 通过下文方法制作的系统高速U盘，在安装的机器上可以反复使用，但是更换机器，不保证可用。

其中第二点，由于现在大部分机器都是 EFI 启动的，在不支持 EFI 的机器上，肯定启动不了。但同样支持 EFI 的机器，也不保证可用。我自己就是 MacBook Pro 安装好，正常使用。但是换到 iMac 上就不可用。

**准备材料**

* 要安装的系统 ISO 文件；
* 安装系统临时用到的U盘，因为大部分机器没有光驱了，换做U盘代替，根据 ISO 文件大小而定，一般 4G 足够；
* 将 ISO 文件写入安装U盘的软件，比如 Etcher 或者 rufus；
* 一个超过 16G 的高速U盘（移动硬盘），太小的装不下系统和软件，建议最少 32G 以上；
* 一台可以操作电脑，必须真机，虚拟机不行，未来就要经常在这台机器上启动Linux；
* 细致的心。因为要真机上操作，有的危险步骤一旦操作错误可能影响这台电脑的系统。

**制作系统U盘方法**

1. 制作操作安装U盘
    1. 电脑上安装 Etcher 或者 rufus，我推荐 Etcher，最简单还漂亮；
    2. 插入临时用的小U盘，启动 Etcher，将 Linux ISO 拖入其中，此时前两步已经完成；如果你插入多个U盘，请自行选择用一个；
    3. 点击 `Flash!` 等待完成。
       ![Etcher](https://cdn1.yukapril.com/2020-04-21-u-pan-1.png)
2. 安装Linux到高速U盘
1. 以下步骤要在未来要常用来启动 Linux 的电脑上操作，务必小心；
2. 插入小U盘和装系统用的高速U盘（移动硬盘），开机。并调整启动顺序，用小U盘启动。
3. 正常加载 Linux，并进入安装界面，一直来到安装位置选择页，并选择“自定义位置安装” 之类选项；
4. 你可以见到如下图内容。通过容量可以看出来，`/dev/sda` 是我的 MacBook Pro 自带的 SSD 硬盘，`/dev/sdb` 是我插入并要安装 Linux 的 500G 移动硬盘， `/dev/sdc` 不用管，其实是 MacBook Pro 的读卡器。*
   *我们要在计划装系统的盘上操作，其他盘不要点，也不要操作**。首先是看是否有分区，我的 `/dev/sdb` 没有分区了，如果你的有，点击对应的分区（是分区不是硬盘，可能叫做 `/dev/sdb1`）后点击下面的 `减号`
   来删除，请删除干净。此外建议选中计划装系统的盘（是硬盘不是分区，比如截图是 `dev/sdb`），选择 `新建分区表` 来重建分区表；
   ![Linux 分区管理](https://cdn1.yukapril.com/2020-04-21-u-pan-2.jpg)
5. 删除干净后，我们来新建 EFI 启动分区。如下图，在空闲区上，点击 `加号` 新建分区。大小为 300-500MB 左右都行。如果计划装多个系统，可以多分配一点。分区类型为 `主分区`，用于 `EFI`；
   ![建立 EFI 分区](https://cdn1.yukapril.com/2020-04-21-u-pan-3.jpg)
6. 接下来建立系统分区。选择空闲区上，点击 `加号` 新建分区。容量根据使用情况来定。我的截图是 150G。分区类型无所谓，哪一个都可以启动系统，但是选择 `主分区` 可以让编号更靠前，以后好管理。用于一般都是 `Ext4`
   ，可以根据你的系统支持情况进行变通。最后挂载点选择 `/`；
   ![建立系统分区](https://cdn1.yukapril.com/2020-04-21-u-pan-4.jpg)
7. **非常重要**。选择 `安装启动引导器的设备`，改为你装 Linux 的硬盘，比如我的是 `/dev/sdb/` （我测试选择 EFI 分区 `/dev/sdb1` 也可以，不知道两者区别）；
8. 点击 `现在安装`，并完成后续相关设置，完成 Linux 的安装过程。

**使用方法**

在安装系统的机器上。直接插上装有 Linux 的高速U盘，配置下开机启动顺序即可，很简单。Mac 则是开机按住 `option/alt`，然后选择 `EFI Boot`。

在非安装系统的机器上，我自己测试换了台 Mac 是不行的。普通 PC 机我没有，不确定具体情况。

--END--
